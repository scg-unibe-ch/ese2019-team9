<ion-header>
	<ion-toolbar>
		<app-header></app-header>
	</ion-toolbar>
</ion-header>
<ion-content>
	<ion-title *ngIf="!product && isLoading" class="statusMessage">
		... Loading ...
	</ion-title>
	<ion-title *ngIf="!product && !isLoading" class="statusMessage">
		Sorry, this product doesn't exist!
	</ion-title>
	<ion-grid *ngIf="product">
		<ion-row>
			<ion-col class="product-image-container" size="12" size-md="6">
				<ion-thumbnail class="product-image"><ion-img [src]="product.image || 'https://lorempixel.com/300/300/cats/'"></ion-img></ion-thumbnail>
			</ion-col>
			<ion-col size="12" size-md="6">
				<ion-list lines="none">
					<ion-item class="ion-text-capitalize product-title">{{ product.name }}</ion-item>
					<ion-item>Price: <span slot="end">{{ product.price || 'not specified'}}</span></ion-item>
					<ion-item>Category: <span slot="end">{{ product.category.name }}</span></ion-item>
					<ion-item>Seller: <span slot="end">{{ product.seller.name }}</span></ion-item>
					<ion-item>Location: <span slot="end">{{ product.location || 'nowhere'}}</span></ion-item>
					<ion-button fill="empty" class="blueButton" (click) = "onClickBuy();" *ngIf="!orderingDetails && loggedIn && product.seller._id != authService.getId()">Order now</ion-button>
				</ion-list>
				<ion-card *ngIf="orderingDetails">
						<ion-card-header>
							<ion-card-title>Order this product</ion-card-title>
						</ion-card-header>
						<ion-card-content>
								<form [formGroup]="orderForm" (ngSubmit)="onOrder()">
										
										<app-input-form
										[inputForm]="orderForm" [givenName]="'startDate'" [text]="'Event Start*'"
										[validationMessages]="validationMessages.fromDate"
										[type]="'dateTime'" [max]="maxDate" (ionChange)="onChangeStartDate()" [inputMode]="'text'">
										</app-input-form>
										<app-input-form
										[inputForm]="orderForm" [givenName]="'endDate'" [text]="'Event End*'"
										[validationMessages]="validationMessages.toDate"
										[type]="'dateTime'" [max]="maxDate" [min]="orderForm.controls['startDate'].value" [inputMode]="'text'">
										</app-input-form>

										<app-input-form
										[inputForm]="orderForm" [givenName]="'description'" [text]="'Description*'"
										[validationMessages]="validationMessages.description"
										[type]="'text'" [inputMode]="'text'">
										</app-input-form>
	
										<ion-button class="blueButton" fill="empty" type="submit"> Submit </ion-button>
								</form>
								<ion-button class="greyButton" fill="empty" color="danger" (click) = "onClickBuy();" *ngIf="orderingDetails">Cancel</ion-button>
						</ion-card-content>
					</ion-card>
			</ion-col>
		</ion-row>
		<ion-row>
			<ion-col size="12" size-md="6" >
				<span class="product-title">Description</span><br/>
				<ng-container *ngIf="product.description"> {{ product.description }} </ng-container>
				<ng-container *ngIf="!product.description"> This product does not have a description</ng-container>
			</ion-col>
			<ion-col size="12" size-md="6">
				<span class="product-title">Reviews</span>

				
				<p *ngIf="product.reviews.length == 0"> This product has no reviews yet. </p>
				<span *ngFor="let review of product.reviews">
					<app-product-review [review]="review"></app-product-review>
				</span>
			</ion-col>
		</ion-row>
	</ion-grid>
</ion-content>